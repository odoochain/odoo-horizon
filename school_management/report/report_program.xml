<?xml version="1.0" encoding="utf-8" ?>
<!--
##############################################################################
#
#    Copyright (c) 2023 ito-invest.lu
#                       Jerome Sonnet <jerome.sonnet@ito-invest.lu>
#
#    This program is free software: you can redistribute it and/or modify
#    it under the terms of the GNU Affero General Public License as
#    published by the Free Software Foundation, either version 3 of the
#    License, or (at your option) any later version.
#
#    This program is distributed in the hope that it will be useful,
#    but WITHOUT ANY WARRANTY; without even the implied warranty of
#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#    GNU Affero General Public License for more details.
#
#    You should have received a copy of the GNU Affero General Public License
#    along with this program.  If not, see <http://www.gnu.org/licenses/>.
#
##############################################################################
-->
<odoo>

    <!-- report -->
    <!-- <report
        id="report_program"
        model="school.program"
        string="Program"
        report_type="qweb-pdf"
        name="school_management.report_program_details_content"
        file="school_management.report_program_details_content"
    /> -->

    <record id="pdf_a4" model="report.paperformat">
        <field name="name">Custom Paper</field>
        <field name="default" eval="True"/>
        <field name="format">custom</field>
        <field name="page_height">297</field>
        <field name="page_width">210</field>
        <field name="orientation">Portrait</field>
        <field name="margin_top">30</field>
        <field name="margin_bottom">16</field>
        <field name="margin_left">10</field>
        <field name="margin_right">10</field>
        <field name="header_line" eval="False"/>
        <field name="header_spacing">32</field>
        <field name="dpi">80</field>
    </record>

    <!-- Style PDF report -->
    <template id="common_style_documents">
        <t t-set="primary" t-value="env.company.primary_color or 'black'" />
        <t t-set="secondary" t-value="env.company.secondary_color or 'black'" />
        <t t-set="font" t-value="env.company.font or 'Lato'" />

        <style>
            * {
                font-family: <t t-out="font" /> !important;
            }
            .colored-primary {
                color: <t t-out="primary" /> !important;
            }
            .colored-secondary {
                color: <t t-out="secondary" /> !important;
            }
            .colored-black {
                color: #000000;
            }
            .colored-grey {
                color: #6e6e6e;
            }
            .colored-grey, h1, h2, h3, h4, h5, h6 {
                color: #6e6e6e;
            }
            .case-danger {
                background-color: #ff9fa8;
                color: #570810;
                border: 1px solid #570810;
                text-align: center;
                padding: 3mm 15mm;
                width: 100%;
            }
            .case td, .case th {
                padding: 1mm;
            }
            .p-0 {
                padding: 0 !important;
            }
            .p-1 {
                padding: 1mm !important;
            }
            .p-2 {
                padding: 2mm !important;
            }
            .p-3 {
                padding: 3mm !important;
            }
            .p-4 {
                padding: 4mm !important;
            }
            .p-5 {
                padding: 5mm !important;
            }
            .m-0 {
                margin 0 !important;
            }
            .m-1 {
                margin 1mm !important;
            }
            .m-2 {
                margin 2mm !important;
            }
            .m-3 {
                margin 3mm !important;
            }
            .m-4 {
                margin 4mm !important;
            }
            .m-5 {
                margin 5mm !important;
            }
            .pt-0 {
                padding-top: 0 !important;
            }
            .pt-1 {
                padding-top: 1mm !important;
            }
            .pt-2 {
                padding-top: 2mm !important;
            }
            .pt-3 {
                padding-top: 3mm !important;
            }
            .pt-4 {
                padding-top: 4mm !important;
            }
            .pt-5 {
                padding-top: 5mm !important;
            }
            .mt-0 {
                margin-top: 0 !important;
            }
            .mt-1 {
                margin-top: 1mm !important;
            }
            .mt-2 {
                margin-top: 2mm !important;
            }
            .mt-3 {
                margin-top: 3mm !important;
            }
            .mt-4 {
                margin-top: 4mm !important;
            }
            .mt-5 {
                margin-top: 5mm !important;
            }
            .pb-0 {
                padding-bottom: 0 !important;
            }
            .pb-1 {
                padding-bottom: 1mm !important;
            }
            .pb-2 {
                padding-bottom: 2mm !important;
            }
            .pb-3 {
                padding-bottom: 3mm !important;
            }
            .pb-4 {
                padding-bottom: 4mm !important;
            }
            .pb-5 {
                padding-bottom: 5mm !important;
            }
            .mb-0 {
                margin-bottom: 0 !important;
            }
            .mb-1 {
                margin-bottom: 1mm !important;
            }
            .mb-2 {
                margin-bottom: 2mm !important;
            }
            .mb-3 {
                margin-bottom: 3mm !important;
            }
            .mb-4 {
                margin-bottom: 4mm !important;
            }
            .mb-5 {
                margin-bottom: 5mm !important;
            }
            .pl-0 {
                padding-left: 0 !important;
            }
            .pl-1 {
                padding-left: 1mm !important;
            }
            .pl-2 {
                padding-left: 2mm !important;
            }
            .pl-3 {
                padding-left: 3mm !important;
            }
            .pl-4 {
                padding-left: 4mm !important;
            }
            .pl-5 {
                padding-left: 5mm !important;
            }
            .ml-0 {
                margin-left 0 !important;
            }
            .ml-1 {
                margin-left 1mm !important;
            }
            .ml-2 {
                margin-left 2mm !important;
            }
            .ml-3 {
                margin-left 3mm !important;
            }
            .ml-4 {
                margin-left 4mm !important;
            }
            .ml-5 {
                margin-left 5mm !important;
            }
            .pr-0 {
                padding-right: 0 !important;
            }
            .pr-1 {
                padding-right: 1mm !important;
            }
            .pr-2 {
                padding-right: 2mm !important;
            }
            .pr-3 {
                padding-right: 3mm !important;
            }
            .pr-4 {
                padding-right: 4mm !important;
            }
            .pr-5 {
                padding-right: 5mm !important;
            }
            .mr-0 {
                margin-right: 0 !important;
            }
            .mr-1 {
                margin-right: 1mm !important;
            }
            .mr-2 {
                margin-right: 2mm !important;
            }
            .mr-3 {
                margin-right: 3mm !important;
            }
            .mr-4 {
                margin-right: 4mm !important;
            }
            .mr-5 {
                margin-right: 5mm !important;
            }

            .text-regular {
                font-weight: 400;
            }
            .text-bold {
                font-weight: 600;
            }
            .text-italic {
                font-style: italic;
            }
            .text-align-left {
                text-align: left;
            }
            .text-align-center {
                text-align: center;
            }
            .text-align-right {
                text-align: right;
            }
            thead,
            tbody,
            tr,
            th,
            td {
                border: 0;
            }
    
            th,
            td {
                vertical-align: top;
            }
            .case {
                border: 1px solid <t t-out="secondary" />;
            }
            .border-top-light-grey {
                border-top: 1px solid rgba(0, 0, 0, 0.1) !important;
            }
            .border-bottom-light-grey {
                border-bottom: 1px solid rgba(0, 0, 0, 0.1) !important;
            }
            .border-top-grey {
                border-top: 1px solid <t t-out="secondary" /> !important;
            }
            .border-bottom-grey {
                border-bottom: 1px solid <t t-out="secondary" /> !important;
            }
            .border-left-grey {
                border-left: 1px solid <t t-out="secondary" /> !important;
            }
            .border-right-grey {
                border-right: 1px solid <t t-out="secondary" /> !important;
            }
            .text-capitalized {
                text-transform: capitalize;
            }
            .font-size-0_7 {
                font-size: 0.7em !important;
            }
            .font-size-0_8 {
                font-size: 0.8em !important;
            }
            .font-size-0_9 {
                font-size: 0.9em !important;
            }
            .font-size-1_1 {
                font-size: 1.1em !important;
            }
            .font-size-1_2 {
                font-size: 1.2em !important;
            }
            .font-size-1_3 {
                font-size: 1.3em !important;
            }
            .font-size-1_4 {
                font-size: 1.4em !important;
            }
            .w-100 {
                width: 100%;
            }
            .d-block {
                display: block;
            }
            .row {
                display: -webkit-box; /* wkhtmltopdf uses this one */
                display: flex;
                -webkit-box-pack: center; /* wkhtmltopdf uses this one */
                justify-content: center;
            }

            .row > div {
                -webkit-box-flex: 1;
                -webkit-flex: 1;
                flex: 1;
            }

            .row > div:last-child {
                margin-right: 0;
            }
            table {
                border-collapse: collapse; 
            }
    
            .table-row-title th,
            .table-row-title td {
                vertical-align: middle;
            }
            .white-space-nowrap {
                white-space: nowrap;
            }
        </style>
    </template>

    <!-- Header & footer PDF report -->
    <template id="header_footer_document">
        <t t-set="primary" t-value="env.company.primary_color or 'black'" />
        <t t-set="secondary" t-value="env.company.secondary_color or 'black'" />
        <t t-set="font" t-value="env.company.font or 'Lato'" />


        <div class="header" style="padding-top: 10mm !important;">
            <div class="row" t-attf-style="padding-bottom: 5mm !important; border-bottom: 1px solid {{secondary}};">
                <div class="col-9 d-flex align-items-center">
                    <img style="max-height: 15mm !important;" t-if="env.company.logo" t-att-src="image_data_uri(env.company.logo)"/>
                    <h3 t-attf-style="font-size: 20px; padding-top: 5mm !important; padding-left: 6mm; color: #6e6e6e; font-family: {{font}} !important;" t-out="env.company.name"/>
                </div>
                <div class="col-3">
                    <img style="max-height: 15mm !important;" src="/school_management/static/src/img/WBE_logo_horizontal.png"/>
                </div>
            </div>
        </div>

        <div class="article o_report_layout_standard" t-att-data-oe-model="o and o._name" t-att-data-oe-id="o and o.id">
            <t t-call="school_management.common_style_documents" />
            <t t-out="0" />
        </div>

        <div class="footer" t-attf-style="border-top: 1px solid {{secondary}}; padding-top: 4mm !important; font-size: 0.7em; color: #6e6e6e; font-family: {{font}} !important;">
            <div class="row">
                <div class="col-11">
                    <p>
                        <t t-out="env.company.website"/>
                        <span t-attf-style="color: {{primary}}; padding-left: 1mm !important; padding-right: 1mm !important;">|   </span>
                        <t t-out="env.company.email"/>
                        <span t-attf-style="color: {{primary}}; padding-left: 1mm !important; padding-right: 1mm !important;">|   </span>
                        <t t-out="env.company.street"/>
                        <t t-out="env.company.street2"/>
                        -
                        <t t-out="env.company.zip"/>
                        <t t-out="env.company.city"/>
                    </p>
                </div>
                <div class="col-1 text-end">
                    Page : <span class="page"/> / <span class="topage"/>
                </div>
            </div>
        </div>
    </template>

    <!-- Attendance report -->
     <report
        id="report_attendance_for_student"
        model="school.individual_bloc"
        string="Attendance Report for Student"
        report_type="qweb-pdf"
        name="school_management.report_attendance_for_student_content"
        file="school_management.report_attendance_for_student_content"
        attachment_use="True"
        attachment="object.name+' - Attestation de frequentation - '+time.strftime('%d-%m-%Y')"
    />

    <record id="report_attendance_for_student" model="ir.actions.report">
        <field name="print_report_name">object.name+' - Attestation de fréquentation - '+time.strftime('%d-%m-%Y')</field>
        <field name="paperformat_id" ref="school_management.pdf_a4"/>
    </record>

    <template id="report_attendance_for_student_content">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="o">
                <t t-call="school_management.header_footer_document"> 
                    <div class="row">
                        <div class="col-12 text-center pt-5">
                            <h1 class="colored-primary pt-5 mb-5">ATTESTATION DE FRÉQUENTATION</h1>
                            <div class="pt-5 mt-5 pb-5 mb-5">
                                <h2 class="color-black">Conservatoire royal de Liège</h2>
                                <h6 class="color-grey">Boulevard Piercot, 29 - 4000 Liège</h6>
                            </div>
                            <div class="mt-5 mb-5">
                                <h6 class="colored-grey">Année académique&amp;nbsp;:</h6>
                                <h3 class="colored-primary" t-field="o.year_id" />
                            </div>
                        </div>
                    </div>
                    <div class="row mt-5 pt-5">
                        <div class="col-12 text-center pt-5">
                            <p>
                                Je soussigné, Nathanaël HARCQ, Directeur du Conservatoire Royal de Liège, certifie que
                            </p>
                            <p>
                                <t t-if="o.student_id.gender == 'male'">Monsieur</t>
                                <t t-if="o.student_id.gender == 'female'">Madame</t> <span t-field="o.student_id" /> <span t-field="o.student_id.initials" /><br />Né<t t-if="o.student_id.gender == 'female'">e</t> à <span t-field="o.student_id.birthplace" /> le <span t-field="o.student_id.birthdate_date"/>
                            </p>
                            <p>
                                est régulièrement inscrit<t t-if="o.student_id.gender == 'female'">e</t> aux cours du jour de l'Enseignement Supérieur Artistique de type <span><t t-esc="'long' if o.source_bloc_id.cycle_id.type=='long' else 'court'"/></span> pour l'année <span t-field="o.year_id" />.
                            </p>
                            <p>
                                Les cours sont donnés du <span t-esc="datetime.datetime(o.year_id.startdate.year, o.year_id.startdate.month, o.year_id.startdate.day).strftime('%d/%m/%Y')" /> au <span t-esc="datetime.datetime(o.year_id.enddate.year, o.year_id.enddate.month, o.year_id.enddate.day).strftime('%d/%m/%Y')" />.
                            </p>
                            <h6 class="mt-5 pt-5">
                                Cours suivis dans la nouvelle structure&amp;nbsp;:
                            </h6>
                            <p>
                                <span t-field="o.source_bloc_id.cycle_id" /> - <span t-field="o.source_bloc_id.level" /> du domaine <span t-field="o.source_bloc_domain_id" />, section <span t-field="o.source_bloc_section_id" />, option <span t-field="o.source_bloc_track_id" />, spécialité <span t-field="o.source_bloc_speciality_id" />.                            
                            </p>
                        </div>
                    </div>
                    <div class="row" style="margin-top: 20mm;">
                        <div class="col-12">
                            <p class="colored-grey text-align-center">
                                La présente attestation est délivrée pour renseignements administratifs.
                            </p>
                            <p class="mt-5 pt-5 mb-0 text-align-right">Liège, le <span t-esc="datetime.datetime.now().strftime('%d/%m/%Y')" />.</p>
                            <p class="mt-1 text-align-right">Le Directeur,</p>
                            <p class="text-align-right" style="margin-top:20mm;">Nathanaël HARCQ</p>
                        </div>
                    </div>
                </t>
            </t>
        </t>
    </template>

    <report
        id="report_individual_bloc"
        model="school.individual_bloc"
        string="Individual Bloc Description"
        report_type="qweb-pdf"
        name="school_management.report_individual_bloc_content"
        file="school_management.report_individual_bloc_content"
    />

    <report
        id="report_individual_bloc_draft"
        model="school.individual_bloc"
        string="Individual Bloc Description (Draft)"
        report_type="qweb-pdf"
        name="school_management.report_individual_bloc_content_draft"
        file="school_management.report_individual_bloc_content_draft"
    />

    <record id="report_individual_bloc_draft" model="ir.actions.report">
        <field name="print_report_name">object.name+' - PAE Brouillon - '+time.strftime('%d-%m-%Y')</field>
        <field name="paperformat_id" ref="school_management.pdf_a4"/>
    </record>

    <record id="report_individual_bloc" model="ir.actions.report">
        <field name="print_report_name">object.name+' - PAE - '+time.strftime('%d-%m-%Y')</field>
        <field name="paperformat_id" ref="school_management.pdf_a4"/>
    </record>

     <template id="report_individual_bloc_content_draft"> <!-- TODO : Ajouter module pour le filigrane + Voir avec cliente si le cadre "signature" est conditionnel, si oui, ajouter un t-set avant ici pour le récupérer dans "report_individual_bloc_content" et savoir qu'on est dans la version brouillon et masquer le cadre. + Demander des explications/précisions sur le cadre pour être sûr de ce à quoi il leur sert. -->
        <t t-call="school_management.report_individual_bloc_content" />
    </template>

    <template id="report_individual_bloc_content">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="bloc">
                <t t-call="school_management.header_footer_document"> 

                    <h2 class="font-size-1_3 colored-primary text-regular pt-1 mb-5" t-out="bloc.source_bloc_id.name" />
                    <h3 class="font-size-1_2 colored-secondary"><t t-out="bloc.name" /></h3>
                    <h4 class="font-size-0_9 colored-primary pb-5"><t t-out="bloc.uid" /></h4>
                    <div class="pb-5">
                        <table class="table-program w-100 font-size-0_9 mb-5">
                            <thead>
                                <tr class="table-row-title border-top-grey border-bottom-grey">
                                    <th class="colored-grey font-size-0_7 p-2 text-align-left white-space-nowrap">Code UE</th>
                                    <th class="colored-grey font-size-0_7 p-2 text-align-left white-space-nowrap">Unités d'enseignement</th>
                                    <th class="colored-grey font-size-0_7 p-2 text-align-left white-space-nowrap">Heures</th>
                                    <th class="colored-grey font-size-0_7 p-2 text-align-left white-space-nowrap">ECTS</th>
                                    <th class="colored-grey font-size-0_7 p-2 text-align-left white-space-nowrap">Pondération</th>
                                </tr>
                            </thead>
                            <tbody class="font-size-0_8">
                                <t t-foreach="bloc.course_group_ids" t-as="course_group">
                                    <tr class="border-top-grey">
                                        <td class="p-2 text-bold colored-primary  white-space-nowrap" t-out="course_group.source_course_group_id.uid"/>
                                        <td class="p-2 colored-primary" t-out="course_group.title"/>
                                        <td class="p-2 colored-primary text-italic colored-primary" t-out="course_group.total_hours"/>
                                        <td class="p-2 colored-primary" t-out="course_group.total_credits"/>
                                        <td class="p-2 colored-primary"/>
                                    </tr>
                                    <t t-foreach="course_group.course_ids" t-as="course">
                                        <tr>
                                            <td class="p-2" />
                                            <td class="p-2 border-top-light-grey" t-out="course.title"/>
                                            <td class="p-2 border-top-light-grey" t-out="course.hours"/>
                                            <td class="p-2 border-top-light-grey" />
                                            <td class="p-2 border-top-light-grey" t-out="course.weight"/>
                                        </tr>
                                    </t>
                                </t>
                                <tr class="border-top-grey" style="page-break-inside: avoid !important;">
                                    <td></td>
                                    <td class="p-2 colored-primary text-bold font-size-1_2">
                                        TOTAL
                                    </td>
                                    <td class="p-2 colored-primary text-italic colored-primary text-bold font-size-1_2" t-out="bloc.total_hours" />
                                    <td class="p-2 colored-primary text-bold font-size-1_2" t-out="bloc.total_credits" />
                                    <td></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="mt-5" style="page-break-inside: avoid !important;">
                        <div class="case w-100">
                            <div class="p-4">
                                <p class="mt-0 mb-0">
                                    Date et signature de l'étudiant
                                </p>
                                <p t-if="bloc.student_signature_date" class="mt-0 mb-2 colored-grey font-size-0_9">
                                    Le <span t-out="bloc.student_signature_date and bloc.student_signature_date.strftime('%d-%m-%Y')"/>
                                </p>
                                <div t-if="not bloc.student_signature" style="height:20mm; width:55mm;" />
                                <img t-if="bloc.student_signature" style="height:20mm; width:55mm;" t-att-src="bloc.student_signature and image_data_uri(bloc.student_signature)"/>
                                <p class="mt-5">
                                Programme annuel approuvé par la commission des études (séance(s) : ...................................................
                                        <!-- <t t-foreach="bloc.approuval_ids" t-as="app">
                                            <t t-esc="app.date.strftime('%d-%m-%Y')"/>
                                            <t t-if="not app_first and not app_last">
                                                ,
                                            </t>
                                        </t> --> )
                                </p>
                            </div>
                            <div class="row">
                                <div class="col-6 pt-4 pl-4 pr-4 border-right-grey">
                                    <p>
                                        Signature de la/du président(e)<br />de la commission des études
                                    </p>
                                    <div style="height:20mm; width:55mm;" />

                                </div>
                                <div class="col-6 pt-4 pl-4 pr-4">
                                    <p>
                                        Signature de la/du secrétaire<br />de la commission des études
                                    </p>
                                    <div style="height:20mm; width:55mm;" />
                                </div>
                            </div>
                        </div>
                        <p class="text-align-right colored-grey font-size-0_9 mt-5">Imprimé le <span t-out="datetime.datetime.now().strftime('%d/%m/%Y à %H:%M:%S')" /></p>
                    </div>
                </t>
            </t>
        </t>
    </template>


    <!-- ********************************************************************************************** -->

    <template id="website_program_details_content" name="Program Details Content">

        <section class="row">
            <div class="col-md-4"><h4>PROFIL D’ENSEIGNEMENT</h4></div>
            <div class="col-md-6"><h4><t t-esc="program.name" /></h4></div>
            <div class="col-md-2"><h4><t t-esc="program.year_id.name" /></h4></div>
        </section>
        <hr />
        <section>
            <div class="row">
                <div class="col-md-2"><font color="grey">DOMAINE</font></div>
                <div class="col-md-10"><t t-esc="program.domain_name" /></div>
            </div>
            <div class="row">
                <div class="col-md-2"><font color="grey">CYCLE</font></div>
                <div class="col-md-10"><t t-esc="program.cycle_id.name" /></div>
            </div>
            <div class="row">
                <div class="col-md-2"><font color="grey">SECTION</font></div>
                <div class="col-md-10"><t
                        t-esc="program.speciality_id.section_id.name"
                    /></div>
            </div>
            <div class="row">
                <div class="col-md-2"><font color="grey">ORIENTATION</font></div>
                <div class="col-md-10"><t
                        t-esc="program.speciality_id.track_id.name"
                    /></div>
            </div>
            <div class="row">
                <div class="col-md-2"><font color="grey">SPÉCIALITÉ</font></div>
                <div class="col-md-10"><t t-esc="program.speciality_id.name" /></div>
            </div>
        </section>
        <hr />
        <section class="row" t-if="program.description">
            <div class="col-md-12"><h4>VADE MECUM</h4></div>
            <div class="col-md-12" style='white-space: pre-wrap;'><t
                    t-esc="program.description"
                /></div>
            <hr />
        </section>
        <!--<section class="row" t-if="program.competency_ids">
            <div class="col-md-12"><h4>RÉFÉRENTIELS DE COMPÉTENCES ATTENDUES</h4></div>
            <div class="col-md-12">
                <table class="table table-striped">
                    <caption>A la fin du cycle, l’étudiant doit être capable :</caption>
                    <col width='50px'/>
                    <col width="100%"/><t t-set="comp_cnt" t-value="0"/>
                    <tr t-foreach="program.competency_ids" t-as="comp"><t t-set="comp_cnt" t-value="comp_cnt+1"/>
                        <th scope="row"><bold><t t-esc="comp_cnt"/></bold></th><td><t t-esc="comp.description"/></td>
                    </tr>
                </table>
            </div>
            <hr/>
        </section>-->
        <section class="row">
            <div class="col-md-12">
                <h4>PROGRAMME DES COURS</h4>
            </div>
        </section>
        <section class="row" t-foreach="program.bloc_ids" t-as="bloc">
            <t t-call="school_management.website_school_bloc" />
        </section>
        <hr />
    </template>

    <template id="website_school_bloc" name="Bloc">
        <div class="col-md-12">
            <table class="table table-condensed oe_school_program_table">
                <caption style="font-size: 100%;">Grille du bloc - <t
                        t-esc="bloc.name"
                    /></caption>
                <colgroup>
                    <col style="width:75px" />
                    <col style="width:400px" />
                    <col style="width:60px" />
                    <col style="width:60px" />
                    <col style="width:60px" />
                    <col style="width:150px" />
                    <col style="width:150px" />
                </colgroup>
                <thead>
                    <tr>
                        <th>Code UE</th>
                        <th>Unités d’enseignement</th>
                        <th class="text-center">Heures</th>
                        <th class="text-center">ECTS</th>
                        <th class="text-center">Pond</th>
                        <th>Pré-requis</th>
                        <th>Co-requis</th>
                    </tr>
                </thead>
                <tbody>
                    <t t-foreach="bloc.course_group_ids" t-as="course_group">
                    <tr class="oe_school_course_group">
                        <td><t t-esc="course_group.uid" /></td>
                        <td><t t-esc="course_group.title" /><br /><i
                                    style="color:grey;"
                                ><t t-esc="course_group.responsible_id.name" /></i></td>
                        <td class="text-center"><t
                                    t-esc="course_group.total_hours"
                                /></td>
                        <td class="text-center"><t
                                    t-esc="course_group.total_credits"
                                /></td>
                        <td />
                        <td style="font-size: x-small;"><t
                                    t-if="course_group.pre_requisit_ids"
                                ><span
                                        t-esc="', '.join(map( lambda x: str(x.preriquisit_id.uid), course_group.pre_requisit_ids))"
                                    /></t></td>
                        <td style="font-size: x-small;"><t
                                    t-if="course_group.co_requisit_ids"
                                ><span
                                        t-esc="', '.join(map( lambda x: str(x.coriquisit_id.uid), course_group.co_requisit_ids))"
                                    /></t></td>
                    </tr>
                    <tr t-foreach="course_group.course_ids" t-as="course">
                        <td />
                        <td t-if="course.url_ref">
                            <a
                                    t-esc="course.title"
                                    data-toggle="modal"
                                    data-target="#noDescription"
                                    style="cursor: pointer;"
                                />
                            <br /><t t-foreach="course.teacher_ids" t-as="teacher"><i
                                        style="color:grey;"
                                        t-esc="teacher.name"
                                    /><t
                                        t-if="teacher_index &lt; (teacher_size - 1)"
                                    >,</t></t>
                        </td>
                        <td t-if="not course.url_ref">
                            <a
                                    t-esc="course.title"
                                    data-toggle="modal"
                                    data-target="#noDescription"
                                    style="cursor: pointer;"
                                />
                            <br /><t t-foreach="course.teacher_ids" t-as="teacher"><i
                                        style="color:grey;"
                                        t-esc="teacher.name"
                                    /><t
                                        t-if="teacher_index &lt; (teacher_size - 1)"
                                    >,</t></t>
                        </td>
                        <td class="text-center"><t t-esc="course.hours" /></td>
                        <td class="text-center"><t t-esc="course.credits" /></td>
                        <td class="text-center"><t t-esc="course.weight" /></td>
                        <td />
                        <td />
                    </tr>
                    </t>
                    <tr>
                        <td />
                        <td class="text-right">Total :</td>
                        <td class="text-center"><t t-esc="bloc.total_hours" /></td>
                        <td class="text-center"><t t-esc="bloc.total_credits" /></td>
                        <td />
                        <td />
                        <td />
                    </tr>
                </tbody>
            </table>
        </div>
    </template>

    <template id="report_program_details_content">
        <t t-call="web.html_container">
            <t t-set="data_report_margin_top" t-value="45" />
            <t t-set="data_report_header_spacing" t-value="40" />
            <t t-foreach="docs" t-as="program">
            <t t-set="o" t-value="program" />
            <t t-call="web.external_layout">
                <div class="page">
                                

                    <t t-call="school_management.website_program_details_content" />
                </div>
            </t>
            </t>
        </t>
    </template>

    <!--Email template -->
    <record id="email_template_report_individual_bloc" model="mail.template">
        <field name="name">Individual Bloc - Send by Email</field>
        <field
            name="email_to"
        >${(object.student_id.email and '%s &lt;%s&gt;' % (object.student_id.name, object.student_id.email) or '')|safe}</field>
        <field name="subject">Individual Bloc</field>
        <field name="partner_to">${object.student_id.id}</field>
        <field name="model_id" ref="model_school_individual_bloc" />
        <field name="auto_delete" eval="True" />
        <field name="report_template" ref="report_individual_bloc" />
        <field name="report_name">Individual Bloc Details</field>
        <field name="lang">${object.student_id.lang}</field>
        <field name="body_html">
            <![CDATA[
                <div style="font-family: 'Lucida Grande', Ubuntu, Arial, Verdana, sans-serif; font-size: 12px; color: rgb(34, 34, 34); background-color: #FFF; ">
                    <p>Hello ${object.student_id.name},</p>
                    <br/>
                    <p>Your Individual Bloc details is attached to this email. </p>
                    <br/>
                    <p>If you have any question, do not hesitate to contact us.</p>
                    <br/>
                </div>
            ]]>
        </field>
    </record>

    <template id="school_bloc" name="Bloc">
        <div
            class="table-responsive"
            data-oe-model="school_bloc"
            t-att-data-oe-id="bloc.id"
        >
            <table class="table table-sm oe_school_program_table">
                <colgroup>
                    <col style="width:150px" />
                    <col style="width:55%" />
                    <col style="width:60px" />
                    <col style="width:60px" />
                    <col style="width:60px" />
                    <col style="width:100px" />
                </colgroup>
                <thead style="display: table-row-group;">
                    <tr>
                        <th>Code UE</th>
                        <th>Unités d’enseignement</th>
                        <th class="text-center">Heures</th>
                        <th class="text-center">ECTS</th>
                        <th class="text-center">Pond</th>
                        <!--
                        <th>Pré/Co-requis</th>-->
                        <th>Statut</th>
                    </tr>
                </thead>
                <tbody>
                    <t t-foreach="bloc.course_group_ids" t-as="course_group">
                    <tr class="oe_school_course_group">
                        <td><t t-esc="course_group.uid" /></td>
                        <td><t t-esc="course_group.name" /></td>
                        <td class="text-center"><t
                                    t-esc="course_group.total_hours"
                                /></td>
                        <td class="text-center"><t
                                    t-esc="course_group.total_credits"
                                /></td>
                        <td />
                        <!--<td class="text-center">Aucun</td>-->
                        <td>
                            <t t-if="course_group.acquiered == 'A'">Valid.</t>
                        </td>
                    </tr>
                    <tr
                            t-foreach="course_group.course_ids"
                            t-as="course"
                            class="font-italic"
                        >
                        <td />
                        <td t-if="course.url_ref"><a
                                    t-esc="course.title"
                                    t-att-href="course.url_ref"
                                    target="new"
                                /></td>
                        <td t-if="not course.url_ref"><t t-esc="course.title" /></td>
                        <td class="text-center"><t t-esc="course.hours" /></td>
                        <td class="text-center"><!--<t t-esc="course.credits"/>--></td>
                        <td class="text-center"><t t-esc="course.weight" /></td>
                        <!--<td></td>-->
                        <td />
                    </tr>
                    </t>
                    <tr>
                        <td />
                        <td class="text-right">Total :</td>
                        <td class="text-center"><t t-esc="bloc.total_hours" /></td>
                        <td class="text-center"><t t-esc="bloc.total_credits" /></td>
                        <td />
                        <!--<td></td>-->
                        <td />
                    </tr>
                </tbody>
            </table>
        </div>
    </template>

   

   

</odoo>
